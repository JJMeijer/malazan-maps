{% extends "base.html" %}

{% load cdnstaticfiles %}

{% block navbar %}
{% endblock navbar %}

{% block footer %}
    <div class="footer-wrapper-bottom">
        {% include "components/footer.html" %}
    </div>
{% endblock footer %}

{% block content %}
    <div class="map-view-container">
        <div class="left-header-container">
            <div class="navbar">
                <a href="{% url "home" %}">
                    <p class="navbar-site-title">
                        Malazan Maps
                    </p>
                </a>
                <p class="navbar-seperator">
                    >
                </p>
                <p class="navbar-page-title">
                    {{ page_title }}
                </p>
            </div>

            <h1 class="left-header-title">
                {{ page_title }}
            </h1>

            {% include "components/search.html" %}

            <div class="{% if maps|length == 1 %}hidden{% endif %} map-selector-wrapper">
                {% for map_info in maps|dictsortreversed:"map.priority" %}
                    <label class="map-selector-label" for="map-selector-{{ forloop.counter }}">
                        <input
                            class="hidden"
                            type="radio"
                            id="map-selector-{{ forloop.counter }}"
                            name="map-selector"
                            {% if forloop.counter == 1 %}checked{% endif %}
                        >
                        <span class="map-selector-span">
                            {{ map_info.map.name }}
                        </span>
                    </label>
                {% endfor %}
            </div>

            <div class="description-wrapper">
                <p class="description-text">
                    {{ description }} (<a target="_blank" rel="nofollow noopener" href={{wiki_link}}>wiki</a>)
                </p>
            </div>

            <div class="footer-wrapper-left">
                {% include "components/footer.html" %}
            </div>
        </div>

        <div class="maps-wrapper">
            {% for map_info in maps|dictsortreversed:"map.priority" %}
                <div
                    class="{% if forloop.counter > 1 %}hidden{% endif %} map-image-wrapper"
                    id="map-imagewrapper-{{ forloop.counter }}"
                >
                    <img
                        src="{{ map_info.map.image.url }}"
                        class="object-contain"
                        id="map-image-{{ forloop.counter }}"
                        alt="Map of {{map_info.map.name}}"
                        title="Map of {{map_info.map.name}}"
                    >
                    {% if 'marker' in map_info %}
                        <img
                            src="{% cdnstatic "img/marker.webp" %}"
                            class="map-image-marker object-contain"
                            id="map-marker-{{ forloop.counter }}"
                            data-markerx={{ map_info.marker.x }}
                            data-markery={{ map_info.marker.y }}
                            alt="Marker icon for {{ page_title }} on the {{ map_info.map.name }} map."
                            title="{{ page_title }} marker"
                        >
                    {% endif %}
                </div>
            {% endfor %}
            <div
                class="reset-zoom-button hidden"
                id="reset-zoom-button">
                <img
                    src="{% cdnstatic "img/reset-zoom.webp" %}"
                    class="object-contain"
                    alt="Reset Zoom Button"
                    title="Reset Zoom Button"
                >
            </div>
        </div>
        <script src="{% cdnstatic "js/mapview.js" %}"></script>
    </div>
{% endblock content %}
